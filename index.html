<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>姜开颜的博客</title>
  <link rel="icon" href="./assets/pic/枇杷.ico" type="image/x-icon">
  <link rel="stylesheet" href="./assets/css/style.css">
</head>

<body>
  <!-- <div class="header">
    <div class="name">姜开颜的博客</div>
  </div> -->

  <div class="body">
    <div class="sidebar">
      <div class="name">姜开颜的博客</div>
      <nav>
        <ul>
          <li><a href="#section1">文本相似判断</a></li>
          <li><a href="#section9">ChatGPT创作的散文《惊蛰》</a></li>
        </ul>
      </nav>
    </div>

    <div class="main">
      <section id="section1">
        <header>
          <h2>文本相似判断</h2>
          <p>发布日期：2022年2月17日</p>
        </header>
        <p>
          文本相似度判断是指对两个或多个文本进行比较，评估它们之间的相似程度。文本相似度判断的效果很大程度上取决于文本信息的表征方法，
          而深度学习在表示学习上的巨大优势，使得深度学习在文本相似度判断中表现出了很好的效果，下面列举一些常用的深度学习方法：
        <ul>
          <li>基于卷积神经网络的模型：如TextCNN模型，它使用卷积神经网络对文本进行卷积操作，提取文本的局部特征，再通过池化操作进行下采样，最后使用全连接层将特征映射到相似度得分。
          </li>
          <li>基于循环神经网络的模型：如SiameseRNN模型，它使用循环神经网络对文本进行建模，然后计算两个文本之间的相似度得分。还有LSTM和GRU等模型，可以对长文本进行处理。
          </li>
          <li>基于Transformer的模型：如BERT和RoBERTa等预训练语言模型，它们使用Transformer网络结构对文本进行编码，得到文本的向量表示，然后将向量进行相似度计算。
          </li>
          <li>基于双塔结构的模型：如MatchPyramid模型，它使用两个神经网络，每个网络分别对一个文本进行编码，然后通过一个匹配层将两个编码的结果匹配，最后得到文本的相似度得分。</li>
        </ul>
        以上是一些常用的深度学习模型，但是不同的模型适用于不同的场景和数据集，需要根据具体的应用来选择合适的模型。
        下面使用Python进行开发，数据来源使用<a href="https://www.bilibili.com/video/BV1bR4y1v7t8/">自译解系统真的存在吗？</a>视频下评论文本，示例如下：
        <pre>
        data = [
          '[doge]大刘：这不是bug，因为比人类文明等级高的文明一定就会破译我们的语言体系的',
          '这可不一定，我们祖先的楔形文字都没破译明白，都还是地球人呢，更别说外星人了',
          '遇见4维空间遗迹的时候有描写，是基于物理规律进行编写，高等文明更加了解低维度的物理规律。',
          '较真的来讲这只是说了一句话，并没有详细描写细节。',
          '但是有一个会写楔形文字的老祖宗跟你比划就不一样了',
          '但是祖先在写楔形文字的时候并没有主动留下让后人破解的线索。',
          '但是祖先在写楔形文字的时候并没有主动留下让后人破解的线索。',
          '那甲骨文呢[脱单doge]']
        </pre>
        使用Transformer将文本转成向量，使用余弦相似度作为衡量文本相似度的方法:
        <pre>
        import torch
        from transformers import BertModel, BertTokenizer
        # 判断是否存在GPU,存在则优先使用
        device = "cuda:0" if torch.cuda.is_available() else "cpu"
        device = torch.device(device)
        # 从HuggingFace上下载预训练模型,这里使用的是 bert-large-chinese
        model_path = 'bert-large-chinese'
        tokenizer = BertTokenizer.from_pretrained(model_path)
        bert = BertModel.from_pretrained(model_path)
        # 模型和数据加载至GPU
        bert.to(device)
        inputs = tokenizer(list(data), padding=True, return_tensors="pt").to(device)
        # 这里只用推理,所以禁用梯度计算从而可以减少内存占用并提高代码运行速度
        with torch.no_grad():
        outputs = bert(**inputs)
        # 使用 last_hidden_state 的均值作为文本向量表示
        embeddings = outputs.last_hidden_state.mean(axis=1)
        # 计算余弦相似度矩阵
        similarity_matrix = torch.nn.functional.cosine_similarity(embeddings.unsqueeze(1), embeddings.unsqueeze(0),
        dim=-1)
        # 由于使用GPU计算,要想进一步处理结果需要将计算结果放在CPU中
        similarity = similarity_matrix.detach().cpu().numpy().copy()
        # 相似度很高(接近1)的对象在推荐业务中是无效的推荐内容，现在为了方便展示过滤掉
        similarity[similarity > 0.9999] = 0.5
        </pre>
        然后使用 matplotlib 绘制热力图进行展示:<br>
        <img src="./assets/pic/文本相似度矩阵.png" alt="文本相似度矩阵"><br>
        如此便完成了文本相似度计算，从计算结果来看，样本中相似度最高的是这三条：[
        <br>'这可不一定，我们祖先的楔形文字都没破译明白，都还是地球人呢，更别说外星人了',
        <br>'但是有一个会写楔形文字的老祖宗跟你比划就不一样了',
        <br>'但是祖先在写楔形文字的时候并没有主动留下让后人破解的线索。',]
        <br>可以看出来他们都在比较楔形文字破译与自译解系统,话题相关性比较高。
        </p>
      </section>
      <hr>
      <section id="section9">
        <header>
          <h2>《惊蛰》</h2>
          <p>发布日期：2022年2月17日</p>
        </header>
        <p>
          惊蛰，万物醒。清明之前，万物苏醒，草木抽芽，春意盎然，生机勃勃。激烈的春雷，把冬的沉寂和死寂炸得粉碎，为春天打开了大门。
          <br>每年惊蛰的到来，都是一个新的开始。在这个时节里，大地上的所有生命都在等待，等待春天的降临，等待新生的机会。不仅仅是自然界的万物，人类也一样，正如“春天在哪里”的歌词所唱：“春天在哪里，春天在大地上。”春天就在我们身边，我们只需要张开双臂，接受春天的馈赠，享受春天的阳光和空气。
          <br>惊蛰时节，是人们准备开始耕作和播种的时候，是一年中最为忙碌和重要的时节。这是一个充满活力和机遇的季节，也是展现人类智慧和勤劳的时节。对于每一个农夫和种植者来说，惊蛰代表了一个全新的开始，一个新的希望。
          <br>在这个季节里，我们不仅需要喜迎春天的到来，更需要为我们的新生活而努力。我们需要摒弃过去的困境和顾虑，向前迈进，创造属于自己的新生。我们需要像春天一样，勇敢、坚韧、坚强，把阻挡我们前行的一切瓦解，向着自己的目标和未来前行。
          <br>在这个季节里，不仅需要体会生命的复苏和焕发，更需要感受到一种新的可能性。我们可以拥抱春天，拥抱新生，也可以拥抱未来，拥抱希望。只要我们用心感受，用行动践行，那么新生的希望和未来就会属于我们。
          <br>惊蛰是一个转折点，也是一个新的起点。让我们在这个季节里，携手迎接春天的到来，共同创造美好的未来。
        </p>
      </section>
    </div>
  </div>
  </div>

  <div class="footer">
    <p>版权所有 &copy; 2023 姜开颜的博客</p>
  </div>
</body>

</html>